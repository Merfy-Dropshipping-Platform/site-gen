---
import BaseLayout from '../layouts/BaseLayout.astro';
import data from '../data/data.json';
import products from '../data/products.json';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import PopularProducts from '../components/PopularProducts.astro';

const blocks = data?.content ?? [];
const meta = data?.meta ?? {};
const hasProducts = products && products.length > 0;

// Extract header/footer config from data
const headerBlock = blocks.find((b: any) => b.type === 'Header');
const footerBlock = blocks.find((b: any) => b.type === 'Footer');
---
<BaseLayout title={meta?.title ?? 'Мой сайт'} description={meta?.description}>
  <Header {...(headerBlock?.props ?? {})} />

  <main class="flex-1 w-full">
    {blocks.length === 0 && !hasProducts && (
      <section class="text-center py-20 px-5">
        <h1 class="text-5xl font-comfortaa mb-5">Добро пожаловать</h1>
        <p class="text-gray-500 text-lg font-manrope">Ваш стиль, ваша индивидуальность</p>
      </section>
    )}

    {hasProducts && (
      <PopularProducts products={products} />
    )}
  </main>

  <Footer {...(footerBlock?.props ?? {})} />
</BaseLayout>
