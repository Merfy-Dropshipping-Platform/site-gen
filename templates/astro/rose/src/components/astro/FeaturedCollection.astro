---
/**
 * FeaturedCollection.astro -- Static SSG version.
 *
 * Renders a section featuring a single collection with its products.
 * Matches the visual design of react/FeaturedCollection.tsx.
 */
import ProductCard from './ProductCard.astro';
import SectionHeader from '../shared/SectionHeader.astro';

interface ProductData {
  id?: string;
  handle?: string;
  title?: string;
  name?: string;
  price?: number | string;
  compareAtPrice?: number;
  oldPrice?: string;
  images?: Array<{ url: string; alt?: string }>;
  image?: string;
}

interface Props {
  title?: string;
  description?: string;
  collectionHandle?: string;
  products?: ProductData[];
  columns?: number;
  padding?: { top?: number; bottom?: number };
}

const {
  title = 'Коллекция',
  description,
  collectionHandle,
  products = [],
  columns = 4,
  padding = { top: 80, bottom: 80 },
} = Astro.props;
---

<section
  class="w-full"
  style={`padding: ${padding?.top ?? 80}px 0 ${padding?.bottom ?? 80}px;`}
>
  <div class="w-full max-w-7xl mx-auto px-4 sm:px-6 md:px-8 lg:px-10 xl:px-12">
    <SectionHeader title={title} subtitle={description} />

    {products.length === 0 ? (
      <p class="text-center text-gray-500 text-lg py-8">Товары скоро появятся</p>
    ) : (
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-5 md:gap-6 featured-collection-grid">
        {products.map((product) => (
          <ProductCard
            id={product.id}
            handle={product.handle}
            title={product.title ?? product.name}
            price={product.price}
            compareAtPrice={product.compareAtPrice}
            oldPrice={product.oldPrice}
            images={product.images}
            image={product.image}
          />
        ))}
      </div>
    )}

    {collectionHandle && products.length > 0 && (
      <div class="flex justify-center mt-8">
        <a
          href={`/collections/${collectionHandle}`}
          class="px-6 py-3 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:border-gray-500 hover:text-black transition-colors no-underline"
        >
          Смотреть все
        </a>
      </div>
    )}
  </div>
</section>

<style define:vars={{ cols: columns }}>
  @media (min-width: 1024px) {
    .featured-collection-grid {
      grid-template-columns: repeat(var(--cols), 1fr);
    }
  }
</style>
