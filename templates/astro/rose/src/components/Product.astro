---
interface Props {
  image?: string;
  badge?: { enabled?: string; text?: string };
  title?: { enabled?: string; text?: string };
  price?: { enabled?: string; value?: string; oldValue?: string };
  description?: { enabled?: string; text?: string };
  buttons?: {
    enabled?: string;
    addToCart?: { enabled?: string; text?: string };
    buyNow?: { enabled?: string; text?: string };
  };
  variants?: {
    enabled?: string;
    items?: Array<{ label: string; value: string }>;
  };
}

const { image, badge, title, price, description, buttons, variants } = Astro.props;
const showBadge = badge?.enabled !== 'false' && badge?.text;
const showTitle = title?.enabled !== 'false' && title?.text;
const showPrice = price?.enabled !== 'false' && price?.value;
const showDescription = description?.enabled !== 'false' && description?.text;
const showButtons = buttons?.enabled !== 'false';
const showAddToCart = showButtons && buttons?.addToCart?.enabled !== 'false' && buttons?.addToCart?.text;
const showBuyNow = showButtons && buttons?.buyNow?.enabled !== 'false' && buttons?.buyNow?.text;
const showVariants = variants?.enabled !== 'false' && variants?.items && variants.items.length > 0;
---

<section class="max-w-[1200px] mx-auto py-[60px] px-5">
  <div class="grid grid-cols-1 md:grid-cols-2 gap-[60px] max-md:gap-[30px] items-start">
    <div class="relative rounded-2xl overflow-hidden bg-gray-50">
      {image ? (
        <img src={image} alt={title?.text ?? 'Товар'} loading="lazy" class="w-full h-auto object-cover" />
      ) : (
        <div class="aspect-square flex items-center justify-center text-gray-300">
          <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
            <circle cx="8.5" cy="8.5" r="1.5"/>
            <polyline points="21,15 16,10 5,21"/>
          </svg>
        </div>
      )}
      {showBadge && (
        <span class="absolute top-4 left-4 bg-black text-white py-1.5 px-3.5 rounded-md text-[0.85rem] font-medium">
          {badge!.text}
        </span>
      )}
    </div>
    <div>
      {showTitle && (
        <h1 class="font-comfortaa text-[2rem] font-medium text-gray-900 mb-4 leading-[1.2]">{title!.text}</h1>
      )}
      {showPrice && (
        <div class="flex items-center gap-3 mb-6">
          <span class="text-2xl font-semibold text-black">{price!.value}</span>
          {price?.oldValue && (
            <span class="text-lg text-gray-400 line-through">{price.oldValue}</span>
          )}
        </div>
      )}
      {showVariants && (
        <div class="flex flex-wrap gap-2 mb-6">
          {variants!.items!.map((v) => (
            <button class="py-2 px-4 border border-gray-300 rounded-lg bg-white text-sm cursor-pointer transition-colors duration-200 hover:border-black">
              {v.label}
            </button>
          ))}
        </div>
      )}
      {showDescription && (
        <p class="text-[1.05rem] text-gray-600 leading-[1.7] mb-8">{description!.text}</p>
      )}
      {(showAddToCart || showBuyNow) && (
        <div class="flex gap-4 flex-wrap">
          {showAddToCart && (
            <button class="py-3.5 px-8 text-[0.95rem] font-medium rounded-lg border border-gray-300 bg-white text-gray-800 cursor-pointer transition-all duration-200 hover:border-black hover:text-black">
              {buttons!.addToCart!.text}
            </button>
          )}
          {showBuyNow && (
            <button class="py-3.5 px-8 text-[0.95rem] font-medium rounded-lg border-none bg-black text-white cursor-pointer transition-colors duration-200 hover:bg-gray-800">
              {buttons!.buyNow!.text}
            </button>
          )}
        </div>
      )}
    </div>
  </div>
</section>
