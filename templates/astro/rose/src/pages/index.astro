---
import data from '../data/data.json';
import products from '../data/products.json';
import Hero from '../components/Hero.astro';
import TextBlock from '../components/TextBlock.astro';
import ButtonRow from '../components/ButtonRow.astro';
import ProductGrid from '../components/ProductGrid.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';

const blocks = data?.content ?? [];
const meta = data?.meta ?? {};
const hasProducts = products && products.length > 0;
---
<html lang="ru">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{meta?.title ?? 'Мой магазин'}</title>
    {meta?.description && <meta name="description" content={meta.description} />}
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
      :root {
        --rose-50: #fff1f2;
        --rose-100: #ffe4e6;
        --rose-200: #fecdd3;
        --rose-300: #fda4af;
        --rose-400: #fb7185;
        --rose-500: #f43f5e;
        --rose-600: #e11d48;
        --rose-700: #be123c;
        --rose-800: #9f1239;
        --rose-900: #881337;

        --neutral-50: #fafafa;
        --neutral-100: #f5f5f5;
        --neutral-200: #e5e5e5;
        --neutral-300: #d4d4d4;
        --neutral-600: #525252;
        --neutral-700: #404040;
        --neutral-800: #262626;
        --neutral-900: #171717;

        --font-display: 'Cormorant Garamond', Georgia, serif;
        --font-body: 'Inter', system-ui, -apple-system, sans-serif;
      }

      * { box-sizing: border-box; margin: 0; padding: 0; }

      body {
        font-family: var(--font-body);
        color: var(--neutral-800);
        background: var(--neutral-50);
        line-height: 1.6;
      }

      main {
        max-width: 1200px;
        margin: 0 auto;
        padding: 40px 20px 80px;
      }

      section {
        margin-bottom: 60px;
      }

      h1, h2, h3 {
        font-family: var(--font-display);
        font-weight: 500;
        letter-spacing: -0.02em;
      }

      a {
        color: var(--rose-600);
        text-decoration: none;
        transition: color 0.2s;
      }

      a:hover {
        color: var(--rose-700);
      }
    </style>
  </head>
  <body>
    <Header siteName={meta?.title ?? 'ROSE'} />

    <main>
      {blocks.length === 0 && !hasProducts && (
        <section style="text-align: center; padding: 80px 20px;">
          <h1 style="font-size: 3rem; margin-bottom: 20px;">Добро пожаловать</h1>
          <p style="color: var(--neutral-600); font-size: 1.1rem;">Ваш стиль, ваша индивидуальность</p>
        </section>
      )}

      {blocks.map((b) => {
        switch (b.type) {
          case 'Hero':
            return <Hero {...b.props} />;
          case 'TextBlock':
            return <TextBlock {...b.props} />;
          case 'ButtonRow':
            return <ButtonRow {...b.props} />;
          case 'ProductGrid':
            return <ProductGrid products={products} {...b.props} />;
          default:
            return null;
        }
      })}

      {hasProducts && !blocks.some(b => b.type === 'ProductGrid') && (
        <ProductGrid products={products} title="Каталог" />
      )}
    </main>

    <Footer siteName={meta?.title ?? 'ROSE'} />
  </body>
</html>
